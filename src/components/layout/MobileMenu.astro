---
import Button from '../ui/Button.astro';

interface Props {
  isOpen?: boolean;
}

const { isOpen = false } = Astro.props;
---

<!-- Mobile Menu Component - Can be used standalone -->
<div class="desktop:hidden">
  <!-- Overlay -->
  <div 
    id="mobile-menu-overlay" 
    class={`fixed inset-0 bg-black/50 z-40 transition-opacity duration-300 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
    data-close-menu
  ></div>

  <!-- Drawer -->
  <div 
    id="mobile-menu-drawer"
    class={`fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-white z-50 shadow-2xl transition-transform duration-300 ease-out ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}
    role="dialog"
    aria-modal="true"
    aria-label="Mobile navigation menu"
  >
    <div class="flex flex-col h-full">
      <!-- Header -->
      <div class="flex items-center justify-between p-4 border-b border-border">
        <a href="/" class="flex items-center gap-2">
          <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
            <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="currentColor"/>
              <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <span class="text-xl font-semibold text-dark">Cleric</span>
        </a>
        <button 
          data-close-menu
          class="p-2 text-body hover:text-dark hover:bg-gray-100 rounded-lg transition-colors"
          aria-label="Close menu"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Navigation Links -->
      <nav class="flex-1 overflow-y-auto py-4" aria-label="Mobile navigation">
        <ul class="space-y-1 px-4">
          <li>
            <a 
              href="#product" 
              class="block py-3 px-4 text-body hover:text-dark hover:bg-gray-50 rounded-lg transition-colors font-medium"
              data-close-menu
            >
              Product
            </a>
          </li>
          <li>
            <a 
              href="#security" 
              class="block py-3 px-4 text-body hover:text-dark hover:bg-gray-50 rounded-lg transition-colors font-medium"
              data-close-menu
            >
              Security
            </a>
          </li>
          <li>
            <a 
              href="#company" 
              class="block py-3 px-4 text-body hover:text-dark hover:bg-gray-50 rounded-lg transition-colors font-medium"
              data-close-menu
            >
              Company
            </a>
          </li>
          <li>
            <a 
              href="#docs" 
              class="block py-3 px-4 text-body hover:text-dark hover:bg-gray-50 rounded-lg transition-colors font-medium"
              data-close-menu
            >
              Docs
            </a>
          </li>
          <li>
            <a 
              href="#pricing" 
              class="block py-3 px-4 text-body hover:text-dark hover:bg-gray-50 rounded-lg transition-colors font-medium"
              data-close-menu
            >
              Pricing
            </a>
          </li>
        </ul>
      </nav>

      <!-- CTA Buttons -->
      <div class="p-4 border-t border-border space-y-3">
        <Button variant="primary" size="md" class="w-full" onclick="window.openTryItOutModal(); document.body.style.overflow='hidden';">
          Try it out
        </Button>
        <Button variant="outline" size="md" class="w-full" href="#demo">
          Book a demo
        </Button>
      </div>
    </div>
  </div>
</div>

<script>
  function setupMobileMenu() {
    const overlay = document.getElementById('mobile-menu-overlay');
    const drawer = document.getElementById('mobile-menu-drawer');
    const closeButtons = document.querySelectorAll('[data-close-menu]');
    
    function closeMenu() {
      if (drawer) {
        drawer.classList.add('translate-x-full');
        drawer.classList.remove('translate-x-0');
      }
      if (overlay) {
        overlay.classList.add('opacity-0', 'pointer-events-none');
        overlay.classList.remove('opacity-100');
      }
      document.body.style.overflow = '';
    }

    closeButtons.forEach(button => {
      button.addEventListener('click', closeMenu);
    });
  }

  document.addEventListener('DOMContentLoaded', setupMobileMenu);
</script>
